name: 🔒 Security Report
description: Report a security vulnerability (private by default)
title: '[Security]: '
labels: ['security', 'needs-triage']

body:
  - type: markdown
    attributes:
      value: |
        # 🔒 Security Report

        **⚠️ IMPORTANT**: For serious security vulnerabilities, please email vijayanand431@gmail.com directly instead of using this public form.

        Thank you for helping keep **Keypress Notifications** secure! 🛡️

  - type: dropdown
    id: severity
    attributes:
      label: 🚨 Severity Level
      description: How would you rate this security issue?
      options:
        - 🔴 Critical - Immediate action required
        - 🟠 High - Significant security risk
        - 🟡 Medium - Moderate security concern
        - 🟢 Low - Minor security improvement
    validations:
      required: true

  - type: textarea
    id: vulnerability
    attributes:
      label: 🔍 Vulnerability Description
      description: Describe the security issue you found
      placeholder: |
        Example: Extension logs sensitive user data to VS Code output channel
    validations:
      required: true

  - type: textarea
    id: impact
    attributes:
      label: 💥 Potential Impact
      description: What could happen if this vulnerability is exploited?
      placeholder: |
        Example: User's clipboard contents could be logged and visible to other extensions
    validations:
      required: true

  - type: textarea
    id: reproduction
    attributes:
      label: 🔄 Steps to Reproduce
      description: How can we reproduce this security issue?
      placeholder: |
        1. Enable the extension
        2. Copy sensitive text
        3. Check VS Code output channel
        4. Observe logged content
    validations:
      required: true

  - type: dropdown
    id: environment
    attributes:
      label: 💻 Environment
      description: What environment did you discover this in?
      options:
        - VS Code Stable
        - VS Code Insiders
        - Multiple environments
        - Development environment only
    validations:
      required: true

  - type: textarea
    id: additional-info
    attributes:
      label: 📝 Additional Information
      description: Any other relevant details
      validations:
        required: false

  - type: checkboxes
    id: responsible-disclosure
    attributes:
      label: ✅ Responsible Disclosure
      options:
        - label: I understand this will be handled with appropriate confidentiality
          required: true
        - label: I have not shared this vulnerability publicly
          required: true